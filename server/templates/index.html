{% extends 'base.html' %} {% block title %}Biotools linter{% endblock %} {% block extrahead %}{% endblock %} {% block
content %}
<p></p>
<article>
    <h1>Bio.tools linter</h1>
    <p>
        This tool searches the entire <a href="https://bio.tools/">bio.tools database</a> for errors in the to help
        maintainers and editors with data quality.
        Currently serving <code>{{error_count}}</code> errors for <code>{{tool_count}}</code> tools, oldest entry was
        linted at <code>{{last_time}}</code>.

        <br>
        <br>

        Disclaimer: This tool does not cover all possible aspects or validations that can be performed on the data. It
        should be used as an additional tool for evaluating the information retrieved from the bio.tools API.
        Please use this tool responsibly and do not misuse or overwhelm the bio.tools API with excessive requests.
    </p>

    <div id="table"></div>
</article>

<script>
    new gridjs.Grid({
        columns: [{
            name: "Tool name",
            attributes: (cell) => {
                // add break-all to the name column
                if (cell) {
                    return {
                        'style': 'word-break: break-all',
                    }
                }
            }
        },
            "Code",
            "Error",
        {
            name: 'Severity',
            formatter: (cell) => {
                switch (cell) {
                    case 2:
                        return "Linter error";
                        break;
                    case 4:
                        return "Critical"
                        break;
                    case 5:
                        return "High"
                        break;
                    case 6:
                        return "Medium"
                        break;
                    case 7:
                        return "Low"
                        break;
                    default:
                        return "Error";
                }
            }
        },
            "Found at",
            "Links"
        ],
        search: {
            server: {
                url: (prev, keyword) => `${prev}?query=${keyword}`
            },
            debounceTimeout: 750,

        },
        pagination: {
            limit: 100,
            server: {
                url: (prev, page, limit) => `${prev}${prev.includes('?') ? '&' : '?'}page=${page}`
            }
        },
        server: {
            url: '/api/search',
            then: data => data.results.map(entry => [
                gridjs.html(`<a target="_blank" href="https://bio.tools/${entry.tool}" rel="nofollow">${entry.tool}</a>`),
                entry.code,
                gridjs.html(entry.text),
                entry.severity,
                entry.timestamp,
                gridjs.html(`<a target="_blank" href="https://bio.tools/api/tool/${entry.tool}">JSON</a>
                <a target="_blank" href="https://bio.tools/${entry.tool}/edit" rel="nofollow">Edit</a>`)
            ]),
            total: data => data.count
        },
        language: {
            'search': {
                'placeholder': 'üîç Search for name, biotools ID or error code'
            },
        },
        resizable: true,
        width: "100%",
        style: {
            table: {
                'white-space': 'pre-line',
            }
        },
    }).render(document.getElementById("table"));

</script>
{% endblock %}